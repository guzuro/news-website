---
import ArticleHeroWrapper from '../../components/ArticleHeroWrapper.astro'
import CategoryTags from '../../components/CategoryTags.astro'
import Container from '../../components/Container.astro'
import FormatedDate from '../../components/FormatedDate.astro'
import Layout from '../../layouts/Layout.astro'
import { baseApi } from '../../logic/BaseApi'
import { marked } from 'marked'

export async function getStaticPaths() {
  const data = await baseApi('articles', {
    'populate[0]': 'categories',
    'populate[1]': 'cover_image'
  })

  return data.map((article: any) => {
    return {
      params: { slug: article.attributes.slug },
      props: { article }
    }
  })
}

const { article } = Astro.props
---

<Layout title={article.attributes.title}>
  <ArticleHeroWrapper
    coverImagePath={article.attributes.cover_image.data.attributes.formats.thumbnail.url}
  >
    <h1 class="mt-5 font-semibold text-2xl text-teal-500">
      {article.attributes.title}
    </h1>
    <p class="mt-5">
      {article.attributes.description}
    </p>
    <div class="mt-5 flex flex-row items-center justify-between md:items-start">
      <CategoryTags categories={article.attributes.categories} />

      <FormatedDate date={article.attributes.createdAt} />
    </div>
  </ArticleHeroWrapper>
  <Container>
    <div class="flex flex-col lg:flex-row gap-10">
      <div
        class="relative bg-gray-600 text-white z-30 w-full lg:w-2/3 p-10"
        style="top: -70px;"
      >
        <div set:html={marked.parse(article.attributes.text)} />
      </div>
      <div class="w-full lg:w-1/3 mt-5 bg-gray-600 p-10">
        Lorem ipsum dolor sit amet consectetur adipisicing elit. Placeat assumenda soluta vel
        dolorum error! Veritatis cum a excepturi ullam provident vitae dicta possimus explicabo,
        unde sequi quia doloremque tempora voluptates quod inventore repellendus, atque odio enim
        consectetur hic debitis? Id non distinctio quidem sit molestiae consectetur, eius beatae ad
        quia!
      </div>
    </div>
  </Container>
</Layout>
